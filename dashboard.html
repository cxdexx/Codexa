<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Weather Quotes Dashboard</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>

  <!-- Cookie Consent -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js"></script>

  <!-- AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8970628409098313"
          crossorigin="anonymous"></script>

  <!-- Tailwind Config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          animation: {
            fadeIn: "fadeIn 1s ease-in forwards"
          },
          keyframes: {
            fadeIn: {
              "0%": { opacity: "0", transform: "translateY(10px)" },
              "100%": { opacity: "1", transform: "translateY(0)" }
            }
          },
          fontFamily: {
            poppins: ["Poppins", "sans-serif"]
          }
        }
      }
    };
  </script>

  <!-- Cookie Consent + Ad Control -->
  <script>
    window.addEventListener("load", function(){
      window.cookieconsent.initialise({
        palette: {
          popup: { background: "#1e293b" },
          button: { background: "#6366f1", text: "#fff" }
        },
        type: "opt-in",
        content: {
          message: "We use cookies to personalize ads and improve your experience.",
          allow: "Accept All",
          deny: "Reject",
          link: "Learn more",
          href: "/privacy.html"
        },
        onStatusChange: function(status) {
          if (status === "allow") {
            enableAdCookies();
            const email = localStorage.getItem("userEmail") || "";
            fetch("https://codexa-backend.onrender.com/cookie-consent", {
              method: "POST",
              credentials: "include",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ email, consent: true })
            });
          }
        }
      });
    });

    function enableAdCookies() {
      const adScript = document.createElement("script");
      adScript.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";
      adScript.async = true;
      adScript.setAttribute("data-ad-client", "ca-pub-8970628409098313");
      document.head.appendChild(adScript);
    }
  </script>
</head>

<body class="min-h-screen bg-gradient-to-br from-indigo-700 to-purple-900 text-white font-poppins flex flex-col items-center justify-center px-4 py-10 space-y-6">

  <!-- User Info -->
  <div class="flex flex-col sm:flex-row items-center gap-4 sm:gap-8 bg-white/10 p-4 sm:p-6 rounded-2xl shadow-lg animate-fadeIn max-w-xl w-full">
    <div class="flex flex-col items-center">
      <img id="avatar" alt="Avatar" width="100" class="rounded-full border-2 border-white/20 shadow-md"/>
      <label for="avatarInput" class="mt-2 inline-block px-4 py-1 text-sm bg-indigo-500 hover:bg-indigo-600 rounded-full cursor-pointer transition duration-300">
        Change Avatar
      </label>
      <input type="file" id="avatarInput" accept="image/*" class="hidden" />
    </div>

    <div class="text-center sm:text-left">
      <h1 class="text-2xl sm:text-3xl font-bold text-white">Welcome back, <span id="username">User</span> üëã</h1>
      <p id="greeting" class="text-lg text-white/90 mt-1"></p>
      <p id="email" class="text-sm text-white/60 mt-1"></p>
      <button
        id="logoutBtn" onclick="logout()"
        class="mt-4 bg-blue-500 hover:bg-red-600 text-white px-4 py-2 rounded-full transition">
        Logout
      </button>
    </div>
  </div>

  <!-- Mood Selector and Save -->
  <div class="flex flex-col sm:flex-row gap-3 items-center">
    <select id="mood" class="bg-white/10 text-white p-2 rounded-lg">
      <option value="Motivation">Motivation</option>
      <option value="Love">Love</option>
      <option value="Sadness">Sadness</option>
    </select>
    <button onclick="saveQuote()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg">
      Save Quote
    </button>
  </div>

  <!-- Weather -->
  <div id="weatherSection" class="backdrop-blur-md bg-white/10 border border-white/20 p-6 rounded-2xl w-full max-w-md text-center animate-fadeIn">
    <h2 class="text-xl font-semibold mb-2">üå¶Ô∏è Weather</h2>
    <p id="weatherInfo" class="text-white/80">Loading current weather...</p>
  </div>

  <!-- Quote of the Moment -->
  <div id="quoteSection" class="backdrop-blur-md bg-white/10 border border-white/20 p-6 rounded-2xl w-full max-w-md text-center space-y-3 animate-fadeIn">
    <h2 class="text-xl font-semibold mb-2">üí¨ Quote of the Moment</h2>
    <p id="quoteText" class="italic text-white/70">Fetching quote...</p>

    <select id="moodSelect" class="w-full bg-white/10 text-white/80 px-4 py-2 rounded-lg border border-white/30">
      <option value="">Select Mood</option>
      <option value="üî• Motivation">üî• Motivation</option>
      <option value="üíî Heartbreak">üíî Heartbreak</option>
      <option value="üßò Calm">üßò Calm</option>
      <option value="üí° Thoughtful">üí° Thoughtful</option>
      <option value="üò¢ Sad">üò¢ Sad</option>
    </select>

    <button id="saveQuoteBtn" class="w-full mt-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg">
      ‚ù§Ô∏è Save Quote
    </button>
    <p id="saveStatus" class="text-sm text-white/60 mt-1"></p>
  </div>

  <!-- Saved Quotes -->
  <div id="savedQuotesSection" class="mt-6 w-full max-w-md space-y-2">
    <h3 class="text-lg font-semibold text-white">üóÉÔ∏è Your Saved Quotes</h3>
    <ul id="saved-quotes-list" class="space-y-3"></ul>
  </div>

  <!-- Toast -->
  <div id="toast" class="fixed top-4 right-4 bg-red-600 text-white px-4 py-2 rounded shadow-md hidden z-50 transition-opacity duration-300"></div>

  <!-- AdSense Footer -->
  <footer class="mt-10 w-full max-w-md text-center">
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-8970628409098313"
         data-ad-slot="1449804657"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div>

  </footer>

<!-- Cookie Consent Banner -->
<div id="cookie-banner" class="fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50 max-w-md w-[90%] bg-white/10 backdrop-blur-md text-white p-4 rounded-2xl shadow-lg flex flex-col md:flex-row items-center justify-between gap-4 transition-opacity duration-500 opacity-0 pointer-events-none">
  <p class="text-sm">
    This website uses cookies to enhance your experience. See our 
    <a href="/cookie-policy.html" class="underline text-indigo-300">Cookie Policy</a>.
  </p>
  <button id="accept-cookies" class="bg-indigo-500 hover:bg-indigo-600 text-white text-sm font-semibold px-4 py-2 rounded-xl shadow-md transition">
    Accept
  </button>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const banner = document.getElementById("cookie-banner");
    const acceptBtn = document.getElementById("accept-cookies");

    if (!localStorage.getItem("cookieAccepted")) {
      banner.classList.remove("opacity-0", "pointer-events-none");
    }

    acceptBtn.addEventListener("click", () => {
      localStorage.setItem("cookieAccepted", "true");
      banner.classList.add("opacity-0", "pointer-events-none");
    });
  });
</script>

  <!-- JS Module -->
  <script type="module" src="dashboard.js"></script>
</body>
</html>
